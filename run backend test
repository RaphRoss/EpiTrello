
Run npm test

> epitrello-backend@1.0.0 test
> jest --verbose --coverage

  console.error
    Error fetching lists: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:19:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      23 |         res.json(result.rows.map(toCamelCase));
      24 |     } catch (error) {
    > 25 |         console.error('Error fetching lists:', error);
         |                 ^
      26 |         res.status(500).json({ error: 'Failed to fetch lists' });
      27 |     }
      28 | });

      at error (routes/lists.js:25:17)

  console.error
    Error fetching lists: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:19:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      23 |         res.json(result.rows.map(toCamelCase));
      24 |     } catch (error) {
    > 25 |         console.error('Error fetching lists:', error);
         |                 ^
      26 |         res.status(500).json({ error: 'Failed to fetch lists' });
      27 |     }
      28 | });

      at error (routes/lists.js:25:17)

  console.error
    Error fetching cards: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:19:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      43 |         res.json(cardsWithAttachments);
      44 |     } catch (error) {
    > 45 |         console.error('Error fetching cards:', error);
         |                 ^
      46 |         res.status(500).json({ error: 'Failed to fetch cards' });
      47 |     }
      48 | });

      at error (routes/cards.js:45:17)

  console.error
    Error fetching lists: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:19:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      23 |         res.json(result.rows.map(toCamelCase));
      24 |     } catch (error) {
    > 25 |         console.error('Error fetching lists:', error);
         |                 ^
      26 |         res.status(500).json({ error: 'Failed to fetch lists' });
      27 |     }
      28 | });

      at error (routes/lists.js:25:17)

  console.error
    Error fetching list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:33:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      37 |         res.json(toCamelCase(result.rows[0]));
      38 |     } catch (error) {
    > 39 |         console.error('Error fetching list:', error);
         |                 ^
      40 |         res.status(500).json({ error: 'Failed to fetch list' });
      41 |     }
      42 | });

      at error (routes/lists.js:39:17)

  console.error
    Error fetching cards: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:19:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      43 |         res.json(cardsWithAttachments);
      44 |     } catch (error) {
    > 45 |         console.error('Error fetching cards:', error);
         |                 ^
      46 |         res.status(500).json({ error: 'Failed to fetch cards' });
      47 |     }
      48 | });

      at error (routes/cards.js:45:17)

  console.error
    Registration error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:26:30 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      51 |         });
      52 |     } catch (error) {
    > 53 |         console.error('Registration error:', error);
         |                 ^
      54 |         res.status(500).json({ error: 'Failed to register user' });
      55 |     }
      56 | });

      at error (routes/auth.js:53:17)

  console.error
    Error fetching list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:33:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      37 |         res.json(toCamelCase(result.rows[0]));
      38 |     } catch (error) {
    > 39 |         console.error('Error fetching list:', error);
         |                 ^
      40 |         res.status(500).json({ error: 'Failed to fetch list' });
      41 |     }
      42 | });

      at error (routes/lists.js:39:17)

  console.error
    Error fetching cards: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:19:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      43 |         res.json(cardsWithAttachments);
      44 |     } catch (error) {
    > 45 |         console.error('Error fetching cards:', error);
         |                 ^
      46 |         res.status(500).json({ error: 'Failed to fetch cards' });
      47 |     }
      48 | });

      at error (routes/cards.js:45:17)

  console.error
    Error fetching list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:33:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      37 |         res.json(toCamelCase(result.rows[0]));
      38 |     } catch (error) {
    > 39 |         console.error('Error fetching list:', error);
         |                 ^
      40 |         res.status(500).json({ error: 'Failed to fetch list' });
      41 |     }
      42 | });

      at error (routes/lists.js:39:17)

  console.error
    Registration error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:26:30 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      51 |         });
      52 |     } catch (error) {
    > 53 |         console.error('Registration error:', error);
         |                 ^
      54 |         res.status(500).json({ error: 'Failed to register user' });
      55 |     }
      56 | });

      at error (routes/auth.js:53:17)

  console.error
    Error fetching card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:53:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      74 |         res.json(card);
      75 |     } catch (error) {
    > 76 |         console.error('Error fetching card:', error);
         |                 ^
      77 |         res.status(500).json({ error: 'Failed to fetch card' });
      78 |     }
      79 | });

      at error (routes/cards.js:76:17)

  console.error
    Registration error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:26:30 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      51 |         });
      52 |     } catch (error) {
    > 53 |         console.error('Registration error:', error);
         |                 ^
      54 |         res.status(500).json({ error: 'Failed to register user' });
      55 |     }
      56 | });

      at error (routes/auth.js:53:17)

  console.error
    Error fetching card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:53:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      74 |         res.json(card);
      75 |     } catch (error) {
    > 76 |         console.error('Error fetching card:', error);
         |                 ^
      77 |         res.status(500).json({ error: 'Failed to fetch card' });
      78 |     }
      79 | });

      at error (routes/cards.js:76:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Error fetching card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:53:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      74 |         res.json(card);
      75 |     } catch (error) {
    > 76 |         console.error('Error fetching card:', error);
         |                 ^
      77 |         res.status(500).json({ error: 'Failed to fetch card' });
      78 |     }
      79 | });

      at error (routes/cards.js:76:17)

  console.error
    Login error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:67:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      87 |         });
      88 |     } catch (error) {
    > 89 |         console.error('Login error:', error);
         |                 ^
      90 |         res.status(500).json({ error: 'Failed to login' });
      91 |     }
      92 | });

      at error (routes/auth.js:89:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Login error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:67:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      87 |         });
      88 |     } catch (error) {
    > 89 |         console.error('Login error:', error);
         |                 ^
      90 |         res.status(500).json({ error: 'Failed to login' });
      91 |     }
      92 | });

      at error (routes/auth.js:89:17)

  console.error
    Error creating card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:85:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      129 |         res.status(201).json(card);
      130 |     } catch (error) {
    > 131 |         console.error('Error creating card:', error);
          |                 ^
      132 |         res.status(500).json({ error: 'Failed to create card' });
      133 |     }
      134 | });

      at error (routes/cards.js:131:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Error creating card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:85:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      129 |         res.status(201).json(card);
      130 |     } catch (error) {
    > 131 |         console.error('Error creating card:', error);
          |                 ^
      132 |         res.status(500).json({ error: 'Failed to create card' });
      133 |     }
      134 | });

      at error (routes/cards.js:131:17)

  console.error
    Login error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:67:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      87 |         });
      88 |     } catch (error) {
    > 89 |         console.error('Login error:', error);
         |                 ^
      90 |         res.status(500).json({ error: 'Failed to login' });
      91 |     }
      92 | });

      at error (routes/auth.js:89:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Auth error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:105:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      120 |         });
      121 |     } catch (error) {
    > 122 |         console.error('Auth error:', error);
          |                 ^
      123 |         res.status(500).json({ error: 'Failed to authenticate' });
      124 |     }
      125 | });

      at error (routes/auth.js:122:17)

  console.error
    Error creating card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:85:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      129 |         res.status(201).json(card);
      130 |     } catch (error) {
    > 131 |         console.error('Error creating card:', error);
          |                 ^
      132 |         res.status(500).json({ error: 'Failed to create card' });
      133 |     }
      134 | });

      at error (routes/cards.js:131:17)

  console.error
    Error updating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:86:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      90 |         res.json(toCamelCase(result.rows[0]));
      91 |     } catch (error) {
    > 92 |         console.error('Error updating list:', error);
         |                 ^
      93 |         res.status(500).json({ error: 'Failed to update list' });
      94 |     }
      95 | });

      at error (routes/lists.js:92:17)

  console.error
    Error updating card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:171:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      175 |         res.json(toCamelCase(result.rows[0]));
      176 |     } catch (error) {
    > 177 |         console.error('Error updating card:', error);
          |                 ^
      178 |         res.status(500).json({ error: 'Failed to update card' });
      179 |     }
      180 | });

      at error (routes/cards.js:177:17)

  console.error
    Error updating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:86:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      90 |         res.json(toCamelCase(result.rows[0]));
      91 |     } catch (error) {
    > 92 |         console.error('Error updating list:', error);
         |                 ^
      93 |         res.status(500).json({ error: 'Failed to update list' });
      94 |     }
      95 | });

      at error (routes/lists.js:92:17)

  console.error
    Auth error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:105:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      120 |         });
      121 |     } catch (error) {
    > 122 |         console.error('Auth error:', error);
          |                 ^
      123 |         res.status(500).json({ error: 'Failed to authenticate' });
      124 |     }
      125 | });

      at error (routes/auth.js:122:17)

  console.error
    Error updating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:86:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      90 |         res.json(toCamelCase(result.rows[0]));
      91 |     } catch (error) {
    > 92 |         console.error('Error updating list:', error);
         |                 ^
      93 |         res.status(500).json({ error: 'Failed to update list' });
      94 |     }
      95 | });

      at error (routes/lists.js:92:17)

  console.error
    Registration error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:26:30 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      51 |         });
      52 |     } catch (error) {
    > 53 |         console.error('Registration error:', error);
         |                 ^
      54 |         res.status(500).json({ error: 'Failed to register user' });
      55 |     }
      56 | });

      at error (routes/auth.js:53:17)

  console.error
    Error updating card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:171:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      175 |         res.json(toCamelCase(result.rows[0]));
      176 |     } catch (error) {
    > 177 |         console.error('Error updating card:', error);
          |                 ^
      178 |         res.status(500).json({ error: 'Failed to update card' });
      179 |     }
      180 | });

      at error (routes/cards.js:177:17)

  console.error
    Error updating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:86:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      90 |         res.json(toCamelCase(result.rows[0]));
      91 |     } catch (error) {
    > 92 |         console.error('Error updating list:', error);
         |                 ^
      93 |         res.status(500).json({ error: 'Failed to update list' });
      94 |     }
      95 | });

      at error (routes/lists.js:92:17)

  console.error
    Registration error: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/auth.js:26:30 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      51 |         });
      52 |     } catch (error) {
    > 53 |         console.error('Registration error:', error);
         |                 ^
      54 |         res.status(500).json({ error: 'Failed to register user' });
      55 |     }
      56 | });

      at error (routes/auth.js:53:17)

  console.error
    Error deleting list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:100:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      104 |         res.status(204).send();
      105 |     } catch (error) {
    > 106 |         console.error('Error deleting list:', error);
          |                 ^
      107 |         res.status(500).json({ error: 'Failed to delete list' });
      108 |     }
      109 | });

      at error (routes/lists.js:106:17)

  console.error
    Error updating card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:171:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      175 |         res.json(toCamelCase(result.rows[0]));
      176 |     } catch (error) {
    > 177 |         console.error('Error updating card:', error);
          |                 ^
      178 |         res.status(500).json({ error: 'Failed to update card' });
      179 |     }
      180 | });

      at error (routes/cards.js:177:17)

  console.error
    Error deleting list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:100:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      104 |         res.status(204).send();
      105 |     } catch (error) {
    > 106 |         console.error('Error deleting list:', error);
          |                 ^
      107 |         res.status(500).json({ error: 'Failed to delete list' });
      108 |     }
      109 | });

      at error (routes/lists.js:106:17)

  console.error
    Error updating card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:171:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      175 |         res.json(toCamelCase(result.rows[0]));
      176 |     } catch (error) {
    > 177 |         console.error('Error updating card:', error);
          |                 ^
      178 |         res.status(500).json({ error: 'Failed to update card' });
      179 |     }
      180 | });

      at error (routes/cards.js:177:17)

  console.error
    Error deleting card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:185:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      189 |         res.status(204).send();
      190 |     } catch (error) {
    > 191 |         console.error('Error deleting card:', error);
          |                 ^
      192 |         res.status(500).json({ error: 'Failed to delete card' });
      193 |     }
      194 | });

      at error (routes/cards.js:191:17)

  console.error
    Error deleting list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:100:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      104 |         res.status(204).send();
      105 |     } catch (error) {
    > 106 |         console.error('Error deleting list:', error);
          |                 ^
      107 |         res.status(500).json({ error: 'Failed to delete list' });
      108 |     }
      109 | });

      at error (routes/lists.js:106:17)

  console.error
    Error deleting card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:185:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      189 |         res.status(204).send();
      190 |     } catch (error) {
    > 191 |         console.error('Error deleting card:', error);
          |                 ^
      192 |         res.status(500).json({ error: 'Failed to delete card' });
      193 |     }
      194 | });

      at error (routes/cards.js:191:17)

  console.error
    Error deleting card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:185:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      189 |         res.status(204).send();
      190 |     } catch (error) {
    > 191 |         console.error('Error deleting card:', error);
          |                 ^
      192 |         res.status(500).json({ error: 'Failed to delete card' });
      193 |     }
      194 | });

      at error (routes/cards.js:191:17)

FAIL routes/__tests__/auth.test.js
  Auth API Routes
    POST /api/auth/register
      ✕ should register a new user successfully (150 ms)
      ✓ should return 400 if required fields are missing (9 ms)
      ✕ should return 409 if user already exists (21 ms)
      ✓ should handle file write errors (30 ms)
    POST /api/auth/login
      ✕ should login successfully with valid credentials (18 ms)
      ✓ should return 400 if required fields are missing (6 ms)
      ✕ should return 401 with invalid email (17 ms)
      ✕ should return 401 with invalid password (18 ms)
    GET /api/auth/me
      ✕ should return user info with valid token (21 ms)
      ✓ should return 401 if no token provided (6 ms)
      ✕ should return 401 if token is invalid (20 ms)
    Security
      ✕ should hash passwords before storing (24 ms)
      ✕ should not return password in response (27 ms)

  ● Auth API Routes › POST /api/auth/register › should register a new user successfully

    expected 201 "Created", got 500 "Internal Server Error"

      37 |         .post('/api/auth/register')
      38 |         .send(newUser)
    > 39 |         .expect(201);
         |          ^
      40 |
      41 |       expect(response.body).toHaveProperty('user');
      42 |       expect(response.body).toHaveProperty('token');

      at Object.expect (routes/__tests__/auth.test.js:39:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Auth API Routes › POST /api/auth/register › should return 409 if user already exists

    expected 409 "Conflict", got 500 "Internal Server Error"

      73 |           password: 'password123'
      74 |         })
    > 75 |         .expect(409);
         |          ^
      76 |
      77 |       expect(response.body).toHaveProperty('error', 'User already exists');
      78 |     });

      at Object.expect (routes/__tests__/auth.test.js:75:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Auth API Routes › POST /api/auth/login › should login successfully with valid credentials

    expected 200 "OK", got 500 "Internal Server Error"

      115 |           password: 'password'
      116 |         })
    > 117 |         .expect(200);
          |          ^
      118 |
      119 |       expect(response.body).toHaveProperty('user');
      120 |       expect(response.body).toHaveProperty('token');

      at Object.expect (routes/__tests__/auth.test.js:117:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Auth API Routes › POST /api/auth/login › should return 401 with invalid email

    expected 401 "Unauthorized", got 500 "Internal Server Error"

      139 |           password: 'password'
      140 |         })
    > 141 |         .expect(401);
          |          ^
      142 |
      143 |       expect(response.body).toHaveProperty('error', 'Invalid credentials');
      144 |     });

      at Object.expect (routes/__tests__/auth.test.js:141:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Auth API Routes › POST /api/auth/login › should return 401 with invalid password

    expected 401 "Unauthorized", got 500 "Internal Server Error"

      151 |           password: 'wrongpassword'
      152 |         })
    > 153 |         .expect(401);
          |          ^
      154 |
      155 |       expect(response.body).toHaveProperty('error', 'Invalid credentials');
      156 |     });

      at Object.expect (routes/__tests__/auth.test.js:153:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Auth API Routes › GET /api/auth/me › should return user info with valid token

    expected 200 "OK", got 500 "Internal Server Error"

      175 |         .get('/api/auth/me')
      176 |         .set('Authorization', `***
    > 177 |         .expect(200);
          |          ^
      178 |
      179 |       expect(response.body).toHaveProperty('username', 'testuser');
      180 |       expect(response.body).toHaveProperty('email', 'test@example.com');

      at Object.expect (routes/__tests__/auth.test.js:177:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Auth API Routes › GET /api/auth/me › should return 401 if token is invalid

    expected 401 "Unauthorized", got 500 "Internal Server Error"

      194 |         .get('/api/auth/me')
      195 |         .set('Authorization', '***')
    > 196 |         .expect(401);
          |          ^
      197 |
      198 |       expect(response.body).toHaveProperty('error', 'Invalid token');
      199 |     });

      at Object.expect (routes/__tests__/auth.test.js:196:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Auth API Routes › Security › should hash passwords before storing

    expected 201 "Created", got 500 "Internal Server Error"

      211 |         .post('/api/auth/register')
      212 |         .send(newUser)
    > 213 |         .expect(201);
          |          ^
      214 |
      215 |       const writeCall = fs.writeFileSync.mock.calls[0];
      216 |       const savedData = JSON.parse(writeCall[1]);

      at Object.expect (routes/__tests__/auth.test.js:213:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Auth API Routes › Security › should not return password in response

    expected 201 "Created", got 500 "Internal Server Error"

      229 |           password: 'password123'
      230 |         })
    > 231 |         .expect(201);
          |          ^
      232 |
      233 |       expect(response.body.user).not.toHaveProperty('password');
      234 |     });

      at Object.expect (routes/__tests__/auth.test.js:231:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  console.error
    Error deleting list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:100:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      104 |         res.status(204).send();
      105 |     } catch (error) {
    > 106 |         console.error('Error deleting list:', error);
          |                 ^
      107 |         res.status(500).json({ error: 'Failed to delete list' });
      108 |     }
      109 | });

      at error (routes/lists.js:106:17)

  console.error
    Error fetching cards: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:19:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      43 |         res.json(cardsWithAttachments);
      44 |     } catch (error) {
    > 45 |         console.error('Error fetching cards:', error);
         |                 ^
      46 |         res.status(500).json({ error: 'Failed to fetch cards' });
      47 |     }
      48 | });

      at error (routes/cards.js:45:17)

  console.error
    Error fetching lists: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:19:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      23 |         res.json(result.rows.map(toCamelCase));
      24 |     } catch (error) {
    > 25 |         console.error('Error fetching lists:', error);
         |                 ^
      26 |         res.status(500).json({ error: 'Failed to fetch lists' });
      27 |     }
      28 | });

      at error (routes/lists.js:25:17)

  console.error
    Error fetching card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:53:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      74 |         res.json(card);
      75 |     } catch (error) {
    > 76 |         console.error('Error fetching card:', error);
         |                 ^
      77 |         res.status(500).json({ error: 'Failed to fetch card' });
      78 |     }
      79 | });

      at error (routes/cards.js:76:17)

  console.error
    Error fetching list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:33:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      37 |         res.json(toCamelCase(result.rows[0]));
      38 |     } catch (error) {
    > 39 |         console.error('Error fetching list:', error);
         |                 ^
      40 |         res.status(500).json({ error: 'Failed to fetch list' });
      41 |     }
      42 | });

      at error (routes/lists.js:39:17)

  console.error
    Error creating card: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/cards.js:85:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      129 |         res.status(201).json(card);
      130 |     } catch (error) {
    > 131 |         console.error('Error creating card:', error);
          |                 ^
      132 |         res.status(500).json({ error: 'Failed to create card' });
      133 |     }
      134 | });

      at error (routes/cards.js:131:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Error updating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:86:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      90 |         res.json(toCamelCase(result.rows[0]));
      91 |     } catch (error) {
    > 92 |         console.error('Error updating list:', error);
         |                 ^
      93 |         res.status(500).json({ error: 'Failed to update list' });
      94 |     }
      95 | });

      at error (routes/lists.js:92:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

  console.error
    Error creating list: error: password authentication failed for user "postgres"
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/routes/lists.js:48:24 {
      length: 104,
      severity: 'FATAL',
      code: '28P01',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'auth.c',
      line: '334',
      routine: 'auth_failed'
    }

      52 |         res.status(201).json(toCamelCase(result.rows[0]));
      53 |     } catch (error) {
    > 54 |         console.error('Error creating list:', error);
         |                 ^
      55 |         res.status(500).json({ error: 'Failed to create list' });
      56 |     }
      57 | });

      at error (routes/lists.js:54:17)

FAIL routes/__tests__/cards.test.js
  Cards API Routes
    GET /api/cards/list/:listId
      ✕ should return all cards for a specific list (139 ms)
      ✕ should return empty array for list with no cards (24 ms)
      ✓ should handle file read errors (28 ms)
    GET /api/cards/:id
      ✕ should return a specific card by id (22 ms)
      ✕ should return 404 for non-existent card (19 ms)
      ✓ should handle file read errors (15 ms)
    POST /api/cards
      ✕ should create a new card successfully (27 ms)
      ✕ should create card with default values when optional fields are missing (20 ms)
      ✓ should handle file write errors (21 ms)
    PUT /api/cards/:id
      ✕ should update an existing card (37 ms)
      ✕ should return 404 for non-existent card (24 ms)
      ✕ should partially update card (keep existing fields) (19 ms)
      ✓ should handle file write errors (15 ms)
    DELETE /api/cards/:id
      ✕ should delete an existing card (26 ms)
      ✕ should return 204 even for non-existent card (idempotent) (29 ms)
      ✓ should handle file write errors (18 ms)
    Edge Cases and Data Validation
      ✕ should handle empty cards file (25 ms)
      ✓ should handle malformed JSON (14 ms)
      ✕ should create card with position based on existing cards in list (20 ms)

  ● Cards API Routes › GET /api/cards/list/:listId › should return all cards for a specific list

    expected 200 "OK", got 500 "Internal Server Error"

      57 |       const response = await request(app)
      58 |         .get('/api/cards/list/list1')
    > 59 |         .expect(200);
         |          ^
      60 |
      61 |       expect(response.body).toHaveLength(2);
      62 |       expect(response.body[0].listId).toBe('list1');

      at Object.expect (routes/__tests__/cards.test.js:59:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › GET /api/cards/list/:listId › should return empty array for list with no cards

    expected 200 "OK", got 500 "Internal Server Error"

      67 |       const response = await request(app)
      68 |         .get('/api/cards/list/nonexistent')
    > 69 |         .expect(200);
         |          ^
      70 |
      71 |       expect(response.body).toHaveLength(0);
      72 |       expect(response.body).toEqual([]);

      at Object.expect (routes/__tests__/cards.test.js:69:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › GET /api/cards/:id › should return a specific card by id

    expected 200 "OK", got 500 "Internal Server Error"

      90 |       const response = await request(app)
      91 |         .get('/api/cards/1')
    > 92 |         .expect(200);
         |          ^
      93 |
      94 |       expect(response.body).toHaveProperty('id', '1');
      95 |       expect(response.body).toHaveProperty('title', 'Test Card 1');

      at Object.expect (routes/__tests__/cards.test.js:92:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › GET /api/cards/:id › should return 404 for non-existent card

    expected 404 "Not Found", got 500 "Internal Server Error"

       99 |       const response = await request(app)
      100 |         .get('/api/cards/999')
    > 101 |         .expect(404);
          |          ^
      102 |
      103 |       expect(response.body).toHaveProperty('error', 'Card not found');
      104 |     });

      at Object.expect (routes/__tests__/cards.test.js:101:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › POST /api/cards › should create a new card successfully

    expected 201 "Created", got 500 "Internal Server Error"

      130 |         .post('/api/cards')
      131 |         .send(newCard)
    > 132 |         .expect(201);
          |          ^
      133 |
      134 |       expect(response.body).toHaveProperty('id');
      135 |       expect(response.body).toHaveProperty('title', 'New Test Card');

      at Object.expect (routes/__tests__/cards.test.js:132:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › POST /api/cards › should create card with default values when optional fields are missing

    expected 201 "Created", got 500 "Internal Server Error"

      154 |         .post('/api/cards')
      155 |         .send(newCard)
    > 156 |         .expect(201);
          |          ^
      157 |
      158 |       expect(response.body).toHaveProperty('description', '');
      159 |       expect(response.body).toHaveProperty('dueDate', null);

      at Object.expect (routes/__tests__/cards.test.js:156:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › PUT /api/cards/:id › should update an existing card

    expected 200 "OK", got 500 "Internal Server Error"

      192 |         .put('/api/cards/1')
      193 |         .send(updates)
    > 194 |         .expect(200);
          |          ^
      195 |
      196 |       expect(response.body).toHaveProperty('title', 'Updated Title');
      197 |       expect(response.body).toHaveProperty('description', 'Updated Description');

      at Object.expect (routes/__tests__/cards.test.js:194:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › PUT /api/cards/:id › should return 404 for non-existent card

    expected 404 "Not Found", got 500 "Internal Server Error"

      209 |         .put('/api/cards/999')
      210 |         .send(updates)
    > 211 |         .expect(404);
          |          ^
      212 |
      213 |       expect(response.body).toHaveProperty('error', 'Card not found');
      214 |     });

      at Object.expect (routes/__tests__/cards.test.js:211:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › PUT /api/cards/:id › should partially update card (keep existing fields)

    expected 200 "OK", got 500 "Internal Server Error"

      222 |         .put('/api/cards/1')
      223 |         .send(updates)
    > 224 |         .expect(200);
          |          ^
      225 |
      226 |       expect(response.body).toHaveProperty('title', 'Only Title Updated');
      227 |       expect(response.body).toHaveProperty('listId', 'list1'); // Original value preserved

      at Object.expect (routes/__tests__/cards.test.js:224:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › DELETE /api/cards/:id › should delete an existing card

    expected 204 "No Content", got 500 "Internal Server Error"

      250 |       const response = await request(app)
      251 |         .delete('/api/cards/1')
    > 252 |         .expect(204);
          |          ^
      253 |
      254 |       expect(response.body).toEqual({});
      255 |       

      at Object.expect (routes/__tests__/cards.test.js:252:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › DELETE /api/cards/:id › should return 204 even for non-existent card (idempotent)

    expected 204 "No Content", got 500 "Internal Server Error"

      263 |       const response = await request(app)
      264 |         .delete('/api/cards/999')
    > 265 |         .expect(204);
          |          ^
      266 |
      267 |       expect(response.body).toEqual({});
      268 |     });

      at Object.expect (routes/__tests__/cards.test.js:265:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › Edge Cases and Data Validation › should handle empty cards file

    expected 200 "OK", got 500 "Internal Server Error"

      287 |       const response = await request(app)
      288 |         .get('/api/cards/list/list1')
    > 289 |         .expect(200);
          |          ^
      290 |
      291 |       expect(response.body).toEqual([]);
      292 |     });

      at Object.expect (routes/__tests__/cards.test.js:289:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Cards API Routes › Edge Cases and Data Validation › should create card with position based on existing cards in list

    expected 201 "Created", got 500 "Internal Server Error"

      311 |         .post('/api/cards')
      312 |         .send(newCard)
    > 313 |         .expect(201);
          |          ^
      314 |
      315 |       // list1 already has 2 cards (positions 0 and 1), so new card should be at position 2
      316 |       expect(response.body.position).toBe(2);

      at Object.expect (routes/__tests__/cards.test.js:313:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

FAIL routes/__tests__/lists.test.js
  Lists API Routes
    GET /api/lists/board/:boardId
      ✕ should return all lists for a specific board (134 ms)
      ✕ should return empty array for board with no lists (32 ms)
      ✓ should handle file read errors (34 ms)
    GET /api/lists/:id
      ✕ should return a specific list by id (18 ms)
      ✕ should return 404 for non-existent list (24 ms)
      ✓ should handle file read errors (18 ms)
    POST /api/lists
      ✕ should create a new list successfully (46 ms)
      ✕ should create list with correct position based on existing lists (18 ms)
      ✕ should allow custom position when provided (15 ms)
      ✓ should handle file write errors (23 ms)
    PUT /api/lists/:id
      ✕ should update an existing list (23 ms)
      ✕ should return 404 for non-existent list (19 ms)
      ✕ should partially update list (keep existing fields) (18 ms)
      ✓ should handle file write errors (18 ms)
    DELETE /api/lists/:id
      ✕ should delete an existing list (19 ms)
      ✕ should return 204 even for non-existent list (idempotent) (21 ms)
      ✓ should handle file write errors (19 ms)
      ✕ should successfully delete multiple lists sequentially (66 ms)
    Edge Cases and Data Validation
      ✕ should handle empty lists file (14 ms)
      ✓ should handle malformed JSON (13 ms)
      ✕ should handle very long list names (16 ms)
      ✕ should handle special characters in list names (16 ms)
      ✕ should correctly count lists for position when multiple boards exist (16 ms)
    Integration Scenarios
      ✕ should maintain list order after updates (38 ms)
      ✕ should handle rapid create operations (55 ms)

  ● Lists API Routes › GET /api/lists/board/:boardId › should return all lists for a specific board

    expected 200 "OK", got 500 "Internal Server Error"

      54 |       const response = await request(app)
      55 |         .get('/api/lists/board/board1')
    > 56 |         .expect(200);
         |          ^
      57 |
      58 |       expect(response.body).toHaveLength(2);
      59 |       expect(response.body[0].boardId).toBe('board1');

      at Object.expect (routes/__tests__/lists.test.js:56:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › GET /api/lists/board/:boardId › should return empty array for board with no lists

    expected 200 "OK", got 500 "Internal Server Error"

      66 |       const response = await request(app)
      67 |         .get('/api/lists/board/nonexistent')
    > 68 |         .expect(200);
         |          ^
      69 |
      70 |       expect(response.body).toHaveLength(0);
      71 |       expect(response.body).toEqual([]);

      at Object.expect (routes/__tests__/lists.test.js:68:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › GET /api/lists/:id › should return a specific list by id

    expected 200 "OK", got 500 "Internal Server Error"

      89 |       const response = await request(app)
      90 |         .get('/api/lists/1')
    > 91 |         .expect(200);
         |          ^
      92 |
      93 |       expect(response.body).toHaveProperty('id', '1');
      94 |       expect(response.body).toHaveProperty('name', 'To Do');

      at Object.expect (routes/__tests__/lists.test.js:91:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › GET /api/lists/:id › should return 404 for non-existent list

    expected 404 "Not Found", got 500 "Internal Server Error"

       99 |       const response = await request(app)
      100 |         .get('/api/lists/999')
    > 101 |         .expect(404);
          |          ^
      102 |
      103 |       expect(response.body).toHaveProperty('error', 'List not found');
      104 |     });

      at Object.expect (routes/__tests__/lists.test.js:101:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › POST /api/lists › should create a new list successfully

    expected 201 "Created", got 500 "Internal Server Error"

      127 |         .post('/api/lists')
      128 |         .send(newList)
    > 129 |         .expect(201);
          |          ^
      130 |
      131 |       expect(response.body).toHaveProperty('id');
      132 |       expect(response.body).toHaveProperty('name', 'New List');

      at Object.expect (routes/__tests__/lists.test.js:129:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › POST /api/lists › should create list with correct position based on existing lists

    expected 201 "Created", got 500 "Internal Server Error"

      148 |         .post('/api/lists')
      149 |         .send(newList)
    > 150 |         .expect(201);
          |          ^
      151 |
      152 |       // board1 already has 2 lists (positions 0 and 1), so new list should be at position 2
      153 |       expect(response.body.position).toBe(2);

      at Object.expect (routes/__tests__/lists.test.js:150:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › POST /api/lists › should allow custom position when provided

    expected 201 "Created", got 500 "Internal Server Error"

      164 |         .post('/api/lists')
      165 |         .send(newList)
    > 166 |         .expect(201);
          |          ^
      167 |
      168 |       expect(response.body.position).toBe(5);
      169 |     });

      at Object.expect (routes/__tests__/lists.test.js:166:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › PUT /api/lists/:id › should update an existing list

    expected 200 "OK", got 500 "Internal Server Error"

      198 |         .put('/api/lists/1')
      199 |         .send(updates)
    > 200 |         .expect(200);
          |          ^
      201 |
      202 |       expect(response.body).toHaveProperty('name', 'Updated List Name');
      203 |       expect(response.body).toHaveProperty('position', 5);

      at Object.expect (routes/__tests__/lists.test.js:200:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › PUT /api/lists/:id › should return 404 for non-existent list

    expected 404 "Not Found", got 500 "Internal Server Error"

      215 |         .put('/api/lists/999')
      216 |         .send(updates)
    > 217 |         .expect(404);
          |          ^
      218 |
      219 |       expect(response.body).toHaveProperty('error', 'List not found');
      220 |     });

      at Object.expect (routes/__tests__/lists.test.js:217:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › PUT /api/lists/:id › should partially update list (keep existing fields)

    expected 200 "OK", got 500 "Internal Server Error"

      228 |         .put('/api/lists/1')
      229 |         .send(updates)
    > 230 |         .expect(200);
          |          ^
      231 |
      232 |       expect(response.body).toHaveProperty('name', 'Only Name Updated');
      233 |       expect(response.body).toHaveProperty('boardId', 'board1'); // Original value preserved

      at Object.expect (routes/__tests__/lists.test.js:230:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › DELETE /api/lists/:id › should delete an existing list

    expected 204 "No Content", got 500 "Internal Server Error"

      257 |       const response = await request(app)
      258 |         .delete('/api/lists/1')
    > 259 |         .expect(204);
          |          ^
      260 |
      261 |       expect(response.body).toEqual({});
      262 |       

      at Object.expect (routes/__tests__/lists.test.js:259:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › DELETE /api/lists/:id › should return 204 even for non-existent list (idempotent)

    expected 204 "No Content", got 500 "Internal Server Error"

      271 |       const response = await request(app)
      272 |         .delete('/api/lists/999')
    > 273 |         .expect(204);
          |          ^
      274 |
      275 |       expect(response.body).toEqual({});
      276 |     });

      at Object.expect (routes/__tests__/lists.test.js:273:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › DELETE /api/lists/:id › should successfully delete multiple lists sequentially

    expected 204 "No Content", got 500 "Internal Server Error"

      292 |       await request(app)
      293 |         .delete('/api/lists/1')
    > 294 |         .expect(204);
          |          ^
      295 |
      296 |       // Update mock to reflect first deletion
      297 |       const updatedLists = mockLists.filter(l => l.id !== '1');

      at Object.expect (routes/__tests__/lists.test.js:294:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › Edge Cases and Data Validation › should handle empty lists file

    expected 200 "OK", got 500 "Internal Server Error"

      313 |       const response = await request(app)
      314 |         .get('/api/lists/board/board1')
    > 315 |         .expect(200);
          |          ^
      316 |
      317 |       expect(response.body).toEqual([]);
      318 |     });

      at Object.expect (routes/__tests__/lists.test.js:315:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › Edge Cases and Data Validation › should handle very long list names

    expected 201 "Created", got 500 "Internal Server Error"

      338 |         .post('/api/lists')
      339 |         .send(newList)
    > 340 |         .expect(201);
          |          ^
      341 |
      342 |       expect(response.body.name).toBe(longName);
      343 |     });

      at Object.expect (routes/__tests__/lists.test.js:340:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › Edge Cases and Data Validation › should handle special characters in list names

    expected 201 "Created", got 500 "Internal Server Error"

      353 |         .post('/api/lists')
      354 |         .send(newList)
    > 355 |         .expect(201);
          |          ^
      356 |
      357 |       expect(response.body.name).toBe(specialName);
      358 |     });

      at Object.expect (routes/__tests__/lists.test.js:355:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › Edge Cases and Data Validation › should correctly count lists for position when multiple boards exist

    expected 201 "Created", got 500 "Internal Server Error"

      367 |         .post('/api/lists')
      368 |         .send(newList)
    > 369 |         .expect(201);
          |          ^
      370 |
      371 |       // board2 has 1 list (position 0), so new list should be at position 1
      372 |       expect(response.body.position).toBe(1);

      at Object.expect (routes/__tests__/lists.test.js:369:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › Integration Scenarios › should maintain list order after updates

    expected 200 "OK", got 500 "Internal Server Error"

      380 |         .put('/api/lists/1')
      381 |         .send({ position: 1 })
    > 382 |         .expect(200);
          |          ^
      383 |
      384 |       await request(app)
      385 |         .put('/api/lists/2')

      at Object.expect (routes/__tests__/lists.test.js:382:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Lists API Routes › Integration Scenarios › should handle rapid create operations

    expect(received).toBe(expected) // Object.is equality

    Expected: 201
    Received: 500

      402 |       const responses = await Promise.all(promises);
      403 |       responses.forEach(response => {
    > 404 |         expect(response.status).toBe(201);
          |                                 ^
      405 |       });
      406 |     });
      407 |   });

      at toBe (routes/__tests__/lists.test.js:404:33)
          at Array.forEach (<anonymous>)
      at Object.forEach (routes/__tests__/lists.test.js:403:17)

  console.error
    Error fetching comments: Error: Database error
        at Object.<anonymous> (/home/runner/work/EpiTrello/EpiTrello/backend/routes/__tests__/comments.test.js:55:42)
        at Promise.then.completed (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at _runTest (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/run.js:121:9)
        at run (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-runner/build/testWorker.js:106:12)

      16 |         res.json(result.rows);
      17 |     } catch (error) {
    > 18 |         console.error('Error fetching comments:', error);
         |                 ^
      19 |         res.status(500).json({ error: 'Failed to fetch comments' });
      20 |     }
      21 | });

      at error (routes/comments.js:18:17)

PASS routes/__tests__/comments.test.js
  Comments API
    GET /api/comments/card/:cardId
      ✓ should get all comments for a card (24 ms)
      ✓ should handle database errors (32 ms)
    POST /api/comments
      ✓ should create a new comment (9 ms)
      ✓ should create comment without userId (3 ms)
    PUT /api/comments/:id
      ✓ should update a comment (3 ms)
      ✓ should return 404 if comment not found (2 ms)
    DELETE /api/comments/:id
      ✓ should delete a comment (2 ms)
      ✓ should return 404 if comment not found (3 ms)

  console.error
    Upload error: Error: Write error
        at Object.<anonymous> (/home/runner/work/EpiTrello/EpiTrello/backend/routes/__tests__/uploads.test.js:71:15)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-mock/build/index.js:397:39
        at Object.<anonymous> (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-mock/build/index.js:404:13)
        at Object.mockConstructor (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-mock/build/index.js:148:19)
        at Object.writeFileSync (eval at _createMockFunction (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-mock/build/index.js:566:31), <anonymous>:3:59)
        at writeFileSync (/home/runner/work/EpiTrello/EpiTrello/backend/routes/uploads.js:29:12)
        at Layer.handle [as handle_request] (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/layer.js:95:5)
        at next (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/route.js:149:13)
        at Route.dispatch (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/route.js:119:3)
        at Layer.handle [as handle_request] (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/layer.js:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:284:15
        at Function.process_params (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:346:12)
        at next (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:280:10)
        at Function.handle (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:175:3)
        at router (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:47:12)
        at Layer.handle [as handle_request] (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:328:13)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:346:12)
        at next (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:280:10)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/body-parser/lib/read.js:137:5
        at AsyncResource.runInAsyncScope (node:async_hooks:203:9)
        at invokeCallback (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/raw-body/index.js:238:16)
        at done (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:517:28)
        at endReadableNT (node:internal/streams/readable:1400:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21)

      36 |         });
      37 |     } catch (error) {
    > 38 |         console.error('Upload error:', error);
         |                 ^
      39 |         res.status(500).json({ error: 'Failed to upload file' });
      40 |     }
      41 | });

      at error (routes/uploads.js:38:17)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at Route.dispatch (node_modules/express/lib/router/route.js:119:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at node_modules/express/lib/router/index.js:284:15
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at router (node_modules/express/lib/router/index.js:47:12)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:137:5
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

  console.error
    Delete error: Error: Delete error
        at Object.<anonymous> (/home/runner/work/EpiTrello/EpiTrello/backend/routes/__tests__/uploads.test.js:124:15)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-mock/build/index.js:397:39
        at Object.<anonymous> (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-mock/build/index.js:404:13)
        at Object.mockConstructor (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-mock/build/index.js:148:19)
        at Object.unlinkSync (eval at _createMockFunction (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/jest-mock/build/index.js:566:31), <anonymous>:3:56)
        at unlinkSync (/home/runner/work/EpiTrello/EpiTrello/backend/routes/uploads.js:65:16)
        at Layer.handle [as handle_request] (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/layer.js:95:5)
        at next (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/route.js:149:13)
        at Route.dispatch (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/route.js:119:3)
        at Layer.handle [as handle_request] (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/layer.js:95:5)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:284:15
        at param (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:365:14)
        at param (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:376:14)
        at Function.process_params (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:421:3)
        at next (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:280:10)
        at Function.handle (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:175:3)
        at router (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:47:12)
        at Layer.handle [as handle_request] (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:328:13)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:346:12)
        at next (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:280:10)
        at jsonParser (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/body-parser/lib/types/json.js:113:7)
        at Layer.handle [as handle_request] (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:328:13)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:346:12)
        at next (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:280:10)
        at expressInit (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/middleware/init.js:40:5)
        at Layer.handle [as handle_request] (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:328:13)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:346:12)
        at next (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:280:10)
        at query (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/middleware/query.js:45:5)
        at Layer.handle [as handle_request] (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:328:13)
        at /home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:346:12)
        at next (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:280:10)
        at Function.handle (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/router/index.js:175:3)
        at Function.handle (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/application.js:181:10)
        at Server.app (/home/runner/work/EpiTrello/EpiTrello/backend/node_modules/express/lib/express.js:39:9)
        at Server.emit (node:events:517:28)
        at parserOnIncoming (node:_http_server:1130:12)
        at HTTPParser.parserOnHeadersComplete (node:_http_common:119:17)

      68 |         res.status(204).send();
      69 |     } catch (error) {
    > 70 |         console.error('Delete error:', error);
         |                 ^
      71 |         res.status(500).json({ error: 'Failed to delete file' });
      72 |     }
      73 | });

      at error (routes/uploads.js:70:17)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at Route.dispatch (node_modules/express/lib/router/route.js:119:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at node_modules/express/lib/router/index.js:284:15
      at param (node_modules/express/lib/router/index.js:365:14)
      at param (node_modules/express/lib/router/index.js:376:14)
      at Function.process_params (node_modules/express/lib/router/index.js:421:3)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at router (node_modules/express/lib/router/index.js:47:12)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at jsonParser (node_modules/body-parser/lib/types/json.js:113:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at expressInit (node_modules/express/lib/middleware/init.js:40:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at query (node_modules/express/lib/middleware/query.js:45:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at Function.handle (node_modules/express/lib/application.js:181:10)
      at Server.app (node_modules/express/lib/express.js:39:9)

PASS routes/__tests__/uploads.test.js
  Uploads API Routes
    POST /api/uploads/upload
      ✓ should upload a file successfully (13 ms)
      ✓ should return 400 if required fields are missing (3 ms)
      ✓ should sanitize file names (2 ms)
      ✓ should handle upload errors (14 ms)
    GET /api/uploads/download/:fileName
      ✓ should return 404 for non-existent file (7 ms)
    DELETE /api/uploads/:fileName
      ✓ should delete an existing file (2 ms)
      ✓ should return 204 even if file does not exist (idempotent) (2 ms)
      ✓ should handle deletion errors (6 ms)
    File Security
      ✓ should generate unique file names (15 ms)

----------------|---------|----------|---------|---------|---------------------------------------------------------------------
File            | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                                   
----------------|---------|----------|---------|---------|---------------------------------------------------------------------
All files       |   59.93 |    51.53 |    62.5 |   60.68 |                                                                     
 backend        |   10.41 |    33.33 |       0 |   10.41 |                                                                     
  db.js         |   10.41 |    33.33 |       0 |   10.41 | 16-178                                                              
 backend/routes |   68.45 |       57 |   66.66 |   69.45 |                                                                     
  auth.js       |    65.3 |    57.89 |      60 |    65.3 | 8,13,31-44,72-80,110-116                                            
  cards.js      |   53.48 |    35.29 |   45.45 |   54.76 | 7-13,25-43,54-74,96-129,152-153,156-157,160-161,165,172-175,186-189 
  comments.js   |      85 |    91.66 |     100 |      85 | 50-51,71-72,87-88                                                   
  lists.js      |   66.66 |    58.33 |   71.42 |   68.75 | 7-13,23,34-37,52,75-76,80,87-90,101-104                             
  uploads.js    |    92.1 |    81.81 |     100 |    92.1 | 52-55                                                               
----------------|---------|----------|---------|---------|---------------------------------------------------------------------
Test Suites: 3 failed, 2 passed, 5 total
Tests:       41 failed, 33 passed, 74 total
Snapshots:   0 total
Time:        2.79 s
Ran all test suites.
Error: Process completed with exit code 1.