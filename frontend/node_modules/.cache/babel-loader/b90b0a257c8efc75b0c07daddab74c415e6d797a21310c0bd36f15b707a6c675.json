{"ast":null,"code":"import React,{useState,useEffect}from'react';import{commentsApi,activityApi}from'../services/api';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const CardComments=_ref=>{let{cardId,userId}=_ref;const[comments,setComments]=useState([]);const[activities,setActivities]=useState([]);const[newComment,setNewComment]=useState('');const[activeTab,setActiveTab]=useState('comments');const[loading,setLoading]=useState(false);useEffect(()=>{fetchComments();fetchActivity();},[cardId]);const fetchComments=async()=>{try{const response=await commentsApi.getByCardId(cardId);setComments(response.data);}catch(error){console.error('Failed to fetch comments:',error);}};const fetchActivity=async()=>{try{const response=await activityApi.getByCardId(cardId);setActivities(response.data);}catch(error){console.error('Failed to fetch activity:',error);}};const handleAddComment=async e=>{e.preventDefault();if(!newComment.trim())return;setLoading(true);try{await commentsApi.create({cardId,userId,content:newComment});setNewComment('');await fetchComments();await fetchActivity();}catch(error){console.error('Failed to add comment:',error);alert('Failed to add comment');}finally{setLoading(false);}};const handleDeleteComment=async commentId=>{if(!window.confirm('Are you sure you want to delete this comment?'))return;try{await commentsApi.delete(commentId);await fetchComments();}catch(error){console.error('Failed to delete comment:',error);alert('Failed to delete comment');}};const formatDate=dateString=>{const date=new Date(dateString);return date.toLocaleString();};return/*#__PURE__*/_jsxs(\"div\",{className:\"card-comments-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tabs\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"tab \".concat(activeTab==='comments'?'active':''),onClick:()=>setActiveTab('comments'),children:[\"Comments (\",comments.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"tab \".concat(activeTab==='activity'?'active':''),onClick:()=>setActiveTab('activity'),children:[\"Activity (\",activities.length,\")\"]})]}),activeTab==='comments'&&/*#__PURE__*/_jsxs(\"div\",{className:\"comments-tab\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddComment,className:\"add-comment-form\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:\"Write a comment...\",rows:\"3\",disabled:loading}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading||!newComment.trim(),children:loading?'Adding...':'Add Comment'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comments-list\",children:comments.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-comments\",children:\"No comments yet\"}):comments.map(comment=>/*#__PURE__*/_jsxs(\"div\",{className:\"comment\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-header\",children:[/*#__PURE__*/_jsx(\"strong\",{children:comment.user_name||comment.user_email||'Anonymous'}),/*#__PURE__*/_jsx(\"span\",{className:\"comment-date\",children:formatDate(comment.created_at)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-content\",children:comment.content}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-comment-btn\",onClick:()=>handleDeleteComment(comment.id),children:\"Delete\"})]},comment.id))})]}),activeTab==='activity'&&/*#__PURE__*/_jsx(\"div\",{className:\"activity-tab\",children:/*#__PURE__*/_jsx(\"div\",{className:\"activity-list\",children:activities.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-activity\",children:\"No activity yet\"}):activities.map(activity=>/*#__PURE__*/_jsxs(\"div\",{className:\"activity-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"activity-header\",children:[/*#__PURE__*/_jsx(\"strong\",{children:activity.user_name||activity.user_email||'System'}),/*#__PURE__*/_jsx(\"span\",{className:\"activity-date\",children:formatDate(activity.created_at)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"activity-action\",children:activity.action.replace(/_/g,' ')}),activity.details&&/*#__PURE__*/_jsx(\"div\",{className:\"activity-details\",children:activity.details})]},activity.id))})})]});};export default CardComments;","map":{"version":3,"names":["React","useState","useEffect","commentsApi","activityApi","jsxs","_jsxs","jsx","_jsx","CardComments","_ref","cardId","userId","comments","setComments","activities","setActivities","newComment","setNewComment","activeTab","setActiveTab","loading","setLoading","fetchComments","fetchActivity","response","getByCardId","data","error","console","handleAddComment","e","preventDefault","trim","create","content","alert","handleDeleteComment","commentId","window","confirm","delete","formatDate","dateString","date","Date","toLocaleString","className","children","concat","onClick","length","onSubmit","value","onChange","target","placeholder","rows","disabled","type","map","comment","user_name","user_email","created_at","id","activity","action","replace","details"],"sources":["/home/balghar/Repository/Tec_3/Simulated_work/Epitrello-SIMULATED-/frontend/src/components/CardComments.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { commentsApi, activityApi } from '../services/api';\n\nconst CardComments = ({ cardId, userId }) => {\n  const [comments, setComments] = useState([]);\n  const [activities, setActivities] = useState([]);\n  const [newComment, setNewComment] = useState('');\n  const [activeTab, setActiveTab] = useState('comments');\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    fetchComments();\n    fetchActivity();\n  }, [cardId]);\n\n  const fetchComments = async () => {\n    try {\n      const response = await commentsApi.getByCardId(cardId);\n      setComments(response.data);\n    } catch (error) {\n      console.error('Failed to fetch comments:', error);\n    }\n  };\n\n  const fetchActivity = async () => {\n    try {\n      const response = await activityApi.getByCardId(cardId);\n      setActivities(response.data);\n    } catch (error) {\n      console.error('Failed to fetch activity:', error);\n    }\n  };\n\n  const handleAddComment = async (e) => {\n    e.preventDefault();\n    if (!newComment.trim()) return;\n\n    setLoading(true);\n    try {\n      await commentsApi.create({\n        cardId,\n        userId,\n        content: newComment,\n      });\n      setNewComment('');\n      await fetchComments();\n      await fetchActivity();\n    } catch (error) {\n      console.error('Failed to add comment:', error);\n      alert('Failed to add comment');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDeleteComment = async (commentId) => {\n    if (!window.confirm('Are you sure you want to delete this comment?')) return;\n\n    try {\n      await commentsApi.delete(commentId);\n      await fetchComments();\n    } catch (error) {\n      console.error('Failed to delete comment:', error);\n      alert('Failed to delete comment');\n    }\n  };\n\n  const formatDate = (dateString) => {\n    const date = new Date(dateString);\n    return date.toLocaleString();\n  };\n\n  return (\n    <div className=\"card-comments-section\">\n      <div className=\"tabs\">\n        <button\n          className={`tab ${activeTab === 'comments' ? 'active' : ''}`}\n          onClick={() => setActiveTab('comments')}\n        >\n          Comments ({comments.length})\n        </button>\n        <button\n          className={`tab ${activeTab === 'activity' ? 'active' : ''}`}\n          onClick={() => setActiveTab('activity')}\n        >\n          Activity ({activities.length})\n        </button>\n      </div>\n\n      {activeTab === 'comments' && (\n        <div className=\"comments-tab\">\n          <form onSubmit={handleAddComment} className=\"add-comment-form\">\n            <textarea\n              value={newComment}\n              onChange={(e) => setNewComment(e.target.value)}\n              placeholder=\"Write a comment...\"\n              rows=\"3\"\n              disabled={loading}\n            />\n            <button type=\"submit\" disabled={loading || !newComment.trim()}>\n              {loading ? 'Adding...' : 'Add Comment'}\n            </button>\n          </form>\n\n          <div className=\"comments-list\">\n            {comments.length === 0 ? (\n              <p className=\"no-comments\">No comments yet</p>\n            ) : (\n              comments.map((comment) => (\n                <div key={comment.id} className=\"comment\">\n                  <div className=\"comment-header\">\n                    <strong>{comment.user_name || comment.user_email || 'Anonymous'}</strong>\n                    <span className=\"comment-date\">{formatDate(comment.created_at)}</span>\n                  </div>\n                  <div className=\"comment-content\">{comment.content}</div>\n                  <button\n                    className=\"delete-comment-btn\"\n                    onClick={() => handleDeleteComment(comment.id)}\n                  >\n                    Delete\n                  </button>\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n      )}\n\n      {activeTab === 'activity' && (\n        <div className=\"activity-tab\">\n          <div className=\"activity-list\">\n            {activities.length === 0 ? (\n              <p className=\"no-activity\">No activity yet</p>\n            ) : (\n              activities.map((activity) => (\n                <div key={activity.id} className=\"activity-item\">\n                  <div className=\"activity-header\">\n                    <strong>{activity.user_name || activity.user_email || 'System'}</strong>\n                    <span className=\"activity-date\">{formatDate(activity.created_at)}</span>\n                  </div>\n                  <div className=\"activity-action\">{activity.action.replace(/_/g, ' ')}</div>\n                  {activity.details && (\n                    <div className=\"activity-details\">{activity.details}</div>\n                  )}\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CardComments;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}